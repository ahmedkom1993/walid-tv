import 'dart:convert';
import 'package:flutter/material.dart';
import 'package:flutter/services.dart';
import 'package:audioplayers/audioplayers.dart';

void main() {
  runApp(LanguageApp());
}

class LanguageApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      debugShowCheckedModeBanner: false,
      title: 'تعلم 1000 كلمة',
      theme: ThemeData(primarySwatch: Colors.indigo),
      home: WordListScreen(),
    );
  }
}

class Word {
  final String english;
  final String arabic;
  final String audioEn;
  final String audioAr;

  Word({required this.english, required this.arabic, required this.audioEn, required this.audioAr});

  factory Word.fromJson(Map<String, dynamic> json) {
    return Word(
      english: json['english'],
      arabic: json['arabic'],
      audioEn: json['audioEn'],
      audioAr: json['audioAr'],
    );
  }
}

class WordListScreen extends StatefulWidget {
  @override
  _WordListScreenState createState() => _WordListScreenState();
}

class _WordListScreenState extends State<WordListScreen> {
  List<Word> words = [];
  final AudioPlayer _player = AudioPlayer();
  int repeatCount = 1;

  @override
  void initState() {
    super.initState();
    loadWords();
  }

  Future<void> loadWords() async {
    final String response = await rootBundle.loadString('assets/words.json');
    final data = await json.decode(response) as List;
    setState(() {
      words = data.map((json) => Word.fromJson(json)).toList();
    });
  }

  Future<void> playAudio(String path) async {
    for (int i = 0; i < repeatCount; i++) {
      await _player.play(AssetSource(path));
      await Future.delayed(Duration(seconds: 2));
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text("📘 تعلم 1000 كلمة"),
        centerTitle: true,
        shape: RoundedRectangleBorder(
          borderRadius: BorderRadius.vertical(bottom: Radius.circular(15)),
        ),
      ),
      body: words.isEmpty
          ? Center(child: CircularProgressIndicator())
          : Column(
              children: [
                Padding(
                  padding: const EdgeInsets.all(10.0),
                  child: Row(
                    mainAxisAlignment: MainAxisAlignment.center,
                    children: [
                      Text("مرات التكرار:",
                          style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold)),
                      SizedBox(width: 10),
                      DropdownButton<int>(
                        value: repeatCount,
                        items: List.generate(
                          10,
                          (index) => DropdownMenuItem(
                            child: Text("${index + 1}"),
                            value: index + 1,
                          ),
                        ),
                        onChanged: (value) {
                          setState(() {
                            repeatCount = value!;
                          });
                        },
                      ),
                    ],
                  ),
                ),
                Expanded(
                  child: ListView.builder(
                    itemCount: words.length,
                    itemBuilder: (context, index) {
                      final word = words[index];
                      return Card(
                        margin: EdgeInsets.symmetric(vertical: 6, horizontal: 12),
                        elevation: 5,
                        shape: RoundedRectangleBorder(
                          borderRadius: BorderRadius.circular(15),
                        ),
                        child: ListTile(
                          contentPadding: EdgeInsets.all(15),
                          title: Text(
                            "${word.english} - ${word.arabic}",
                            style: TextStyle(
                                fontSize: 20, fontWeight: FontWeight.bold),
                          ),
                          trailing: Row(
                            mainAxisSize: MainAxisSize.min,
                            children: [
                              IconButton(
                                icon: Icon(Icons.volume_up, color: Colors.blue),
                                onPressed: () => playAudio(word.audioEn),
                              ),
                              IconButton(
                                icon: Icon(Icons.volume_up, color: Colors.green),
                                onPressed: () => playAudio(word.audioAr),
                              ),
                            ],
                          ),
                        ),
                      );
                    },
                  ),
                ),
              ],
            ),
    );
  }
}

ملف الكلمات assets/words.json:

[
  {
    "english": "Computer",
    "arabic": "كمبيوتر",
    "audioEn": "audio/computer_en.mp3",
    "audioAr": "audio/computer_ar.mp3"
  },
  {
    "english": "Keyboard",
    "arabic": "لوحة مفاتيح",
    "audioEn": "audio/keyboard_en.mp3",
    "audioAr": "audio/keyboard_ar.mp3"
  },
  {
    "english": "Mouse",
    "arabic": "ماوس",
    "audioEn": "audio/mouse_en.mp3",
    "audioAr": "audio/mouse_ar.mp3"
  }
]

ملف pubspec.yaml:

flutter:
  uses-material-design: true
  assets:
    - assets/words.json
    - assets/audio/
